// =======================================================================================
// UITooltipHandler
// by Weaver (Fhiz)
// MIT licensed
//
// 
//
// =======================================================================================

using UnityEngine;
using UnityEngine.UI;
using UnityEngine.EventSystems;
using wovencode;

namespace wovencode
{

	// ===================================================================================
	// UITooltipHandler
	// ===================================================================================
	public class UITooltipHandler : MonoBehaviour, IPointerEnterHandler, IPointerExitHandler
	{

		[TextArea(1, 40)] public string tooltipText = "";
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void SetupToolTip()
		{
			UITooltip.singleton.Show(tooltipText);
			UITooltip.singleton.transform.SetParent(transform.root, true);
			UITooltip.singleton.transform.SetAsLastSibling();
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void ShowToolTip(float delay)
		{
			Invoke(nameof(SetupToolTip), delay);
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void HideTooltip()
		{
			CancelInvoke(nameof(ShowToolTip));
			UITooltip.singleton.Hide();
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		public void OnPointerEnter(PointerEventData d)
		{
			ShowToolTip(0.3f);
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		public void OnPointerExit(PointerEventData d)
		{
			HideTooltip();
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void Update()
		{
			UITooltip.singleton.UpdateTooltip(tooltipText);
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void OnDisable()
		{
			HideTooltip();
		}
		
		// -------------------------------------------------------------------------------
		// -------------------------------------------------------------------------------
		void OnDestroy()
		{
			HideTooltip();
		}
	}
	
	// -----------------------------------------------------------------------------------
	
}

// =======================================================================================